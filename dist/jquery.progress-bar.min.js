/*
* progressBar - jQuery framework extensions
*
* Version: 0.0.1a
* Copyright 2011 Alex Tkachev
*
* Dual licensed under MIT or GPLv2 licenses
*   http://en.wikipedia.org/wiki/MIT_License
*   http://en.wikipedia.org/wiki/GNU_General_Public_License
*
* Date: Mon Jul 4 19:25:55 2011 +0300
*/
(function(a){function d(a){var b=[];for(var c in a)b.push({from:parseInt(c,10),css:a[c]});b.sort(function(a,b){a=a.from,b=b.from;return a<b?-1:a===b?0:1});for(var d=1;d<b.length;d++){var e=b[d-1];e.to=b[d].from-1}b[b.length-1].to=100;return b}function c(b){return a('<div class="progress-bar-container"><div class="bar"/><div class="percent"/></div>').appendTo(b)}var b=function(){this.initialize.apply(this,arguments)};a.extend(b.prototype,{initialize:function(b,c){a.extend(this,c),this.el=b.toggleClass("rtl",this.rtl),this.cssRange=d(this.cssRange),this.setValue(this.start)},setValue:function(a){this.value!=a&&(this.value=a%(this.total+1),this.syncUI());return this},setTotal:function(a){this.total!=a&&(this.total=a,this.setValue(this.value));return this},syncUI:function(){var b=Math.round(this.value/this.total*100);jQuery.isNaN(b)&&(b=0);var c=this.el.height(),d=this.el.width(),e=Math.round(b/100*d);a(".bar",this.el).width(e).height(c);var f=a(".percent",this.el);f.html(b+"%").height(c).css({"line-height":c+"px"});var g=e-f.outerWidth(!0);g<0&&(g=0),f.css(this.rtl?{right:g+"px"}:{left:g+"px"});for(var h=0;h<this.cssRange.length;h++){var i=this.cssRange[h];this.el.toggleClass(i.css,i.to>=b&&i.from<=b)}}}),a.fn.progressBar=function(d){var e=a(this).data("api");e||this.each(function(){var e=a(this),f=a.extend(a.fn.progressBar.defaults,d||{});f.rtl=e.css("direction")=="rtl",e.data("api",new b(c(e),f))});return this},a.fn.progressBar.defaults={start:0,total:100,cssRange:{0:"red",30:"orange",75:"green"}}})(jQuery)